THE MAIN WORKING CODE IS IN THE FINAL
